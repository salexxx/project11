{"code":"!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){\"use strict\";n.r(t);class o{constructor(e,t,n,o,r,s,i){this.name=e,this.link=t,this.likes=n,this.elemownerId=o,this.elemId=r,this.userId=s,this.api=i,this.remove=this.remove.bind(this),this.like=this.like.bind(this)}create(){const e=document.createElement(\"div\"),t=document.createElement(\"div\"),n=document.createElement(\"div\"),o=document.createElement(\"div\"),r=document.createElement(\"button\"),s=document.createElement(\"button\"),i=document.createElement(\"span\"),a=document.createElement(\"h3\");return e.classList.add(\"place-card\"),t.classList.add(\"place-card__image\"),t.style.backgroundImage=`url(${this.link})`,t.dataset.url=this.link,r.classList.add(\"place-card__delete-icon\"),n.classList.add(\"place-card__description\"),a.classList.add(\"place-card__nam\"),a.textContent=this.name,s.classList.add(\"place-card__like-icon\"),i.classList.add(\"place-card__like-icon-quantity\"),i.textContent=this.likes,o.classList.add(\"place-card__like-area\"),t.appendChild(r),n.appendChild(a),n.appendChild(o),o.appendChild(s),o.appendChild(i),e.appendChild(t),e.appendChild(n),this.placeCardElement=e,this.setEventListener(),e}setEventListener(){this.placeCardElement.querySelector(\".place-card__like-icon\").addEventListener(\"click\",this.like),this.elemownerId===this.userId&&(this.placeCardElement.querySelector(\".place-card__delete-icon\").style.display=\"block\",this.placeCardElement.querySelector(\".place-card__delete-icon\").addEventListener(\"click\",this.remove))}like(e){e.target.classList.toggle(\"place-card__like-icon_liked\")}remove(e){window.confirm(\"Вы действительно хотите удалить карточку?\")&&(this.api.deleteCard(this.elemId),this.placeCardElement.querySelector(\".place-card__like-icon\").removeEventListener(\"click\",this.like),e.target.removeEventListener(\"click\",this.remove),e.target.closest(\".place-card\").remove())}}class r{constructor(e){this.form=e,this.button=this.form.querySelector(\"button\")}setSubmitButtonState(e){const t=e.nextElementSibling;if(\"\"==e.value)return!1;if(!e.checkValidity()){if(e.validity.valueMissing)return t.textContent=errorMessages.valueMissing,!1;if(e.validity.tooShort)return t.textContent=errorMessages.tooShort,!1;if(e.validity.typeMismatch)return t.textContent=errorMessages.typeMismatch,!1}return t.textContent=\"\",!0}checkInputValidity(e){return this.setSubmitButtonState(e)?(this.button.removeAttribute(\"disabled\",!0),!0):(this.button.setAttribute(\"disabled\",!0),!1)}setEventListener(e){const t=Array.from(this.form.querySelectorAll(\"input\"));this.form.addEventListener(\"input\",()=>{t.every(e=>this.checkInputValidity(e))&&this.button.removeAttribute(\"disabled\",!0)}),t.every(e=>this.checkInputValidity(e))||this.button.setAttribute(\"disabled\",!0)}}const s=document.querySelector(\".user-info__button\"),i=document.querySelector(\".user-info__edit-button\"),a=document.querySelector(\".popup__close\"),c=document.querySelector(\".userpopup__close\");document.querySelector(\".imgpopup__close\");let l=[];new o;const d=new class{constructor(e,t){this.container=e,this.cardsArray=t}addCard(e){this.container.appendChild(e),this.cardsArray.push(e)}render(e){e.forEach(e=>{this.addCard(e)})}}(document.querySelector(\".places-list\"),l),u=new class{constructor(e){this.elem=e}close(){this.elem.classList.remove(\"popup_is-opened\")}open(){this.elem.classList.add(\"popup_is-opened\")}}(document.querySelector(\".popup\")),p=new class{constructor(e){this.elem=e}close(){userform.form.reset(),this.elem.classList.remove(\"popup_is-opened\")}open(){this.elem.classList.add(\"popup_is-opened\")}}(document.querySelector(\".userpopup\")),h=new class{constructor(e){this.event=e}close(e){document.querySelector(\".imgpopup__close\").removeEventListener,this.event.classList.remove(\"popup_is-opened\")}open(e){this.event.querySelector(\".imgpopup__source\").setAttribute(\"src\",e.dataset.url),this.event.classList.add(\"popup_is-opened\"),document.querySelector(\".imgpopup__close\").addEventListener(\"click\",()=>{this.close(e)})}}(document.querySelector(\".imgpopup\")),m=new class{constructor(e,t){this.name=e,this.occupation=t}updateUserInfo(e,t){document.querySelector(\".user-info__name\").textContent=e,document.querySelector(\".user-info__job\").textContent=t}setUserInfo(){this.name=document.querySelector(\".user-info__name\").textContent,this.occupation=document.querySelector(\".user-info__job\").textContent}}(document.querySelector(\".user-info__button\")),_=new r(document.querySelector(\".popup__form\")),f=new r(document.querySelector(\".userpopup__form\"));let v=\"\";const y=new class{constructor(e){this.options=e}_getResponseData(e){return e.ok?e.json():Promise.reject(\"Ошибка: \"+e.status)}getInitialCards(){return fetch(this.options.baseUrl+\"/cards\",{method:\"GET\",headers:{authorization:this.options.headers.authorization}}).then(e=>this._getResponseData(e))}getUser(){return fetch(this.options.baseUrl+\"/users/me\",{method:\"GET\",headers:{authorization:this.options.headers.authorization}}).then(e=>this._getResponseData(e))}editUser(e,t){return fetch(this.options.baseUrl+\"/users/me\",{method:\"PATCH\",headers:{authorization:this.options.headers.authorization,\"Content-Type\":\"application/json\"},body:JSON.stringify({name:e,about:t})}).then(e=>this._getResponseData(e))}addCard(e,t){return fetch(this.options.baseUrl+\"/cards\",{method:\"POST\",headers:{authorization:this.options.headers.authorization,\"Content-Type\":\"application/json\"},body:JSON.stringify({name:e,link:t})}).then(e=>this._getResponseData(e))}deleteCard(e){return fetch(`${this.options.baseUrl}/cards/${e}`,{method:\"DELETE\",headers:{authorization:this.options.headers.authorization}}).then(e=>this._getResponseData(e))}}({baseUrl:\"https://praktikum.tk/cohort10\",headers:{authorization:\"7ef5077b-99dd-460c-a5bd-17774aa4e016\",\"Content-Type\":\"application/json\"}});y.getUser().then(e=>{m.updateUserInfo(e.name,e.about),v=e._id}).catch(e=>{console.log(e)}),y.getInitialCards().then(e=>{console.log(e),l=e.map(e=>new o(e.name,e.link,e.likes.length,e.owner._id,e._id,v,y).create()),d.render(l)}).catch(e=>{console.log(e)}),d.container.addEventListener(\"click\",()=>{event.target.classList.contains(\"place-card__image\")&&h.open(event.target),a.addEventListener(\"click\",()=>{u.close(event.target)})}),s.addEventListener(\"click\",()=>{formElem.reset(),formElem.onsubmit=e=>{e.preventDefault(),y.addCard(e.target.elements.name.value,e.target.elements.link.value).then(e=>{const t=new o(e.name,e.link,e.likes.length,e.owner._id,e._id,v,y);d.addCard(t.create()),u.close()}).catch(e=>console.log(e))},u.open(u),_.setEventListener(event),a.addEventListener(\"click\",()=>{document.querySelectorAll(\".popup__error-message\").forEach(e=>{e.textContent=\"\"}),_.form.reset(),u.close()})}),i.addEventListener(\"click\",()=>{userElem.onsubmit=e=>{e.preventDefault(),y.editUser(e.target.elements.name.value,e.target.elements.occupation.value).then(e=>{m.updateUserInfo(e.name,e.about),p.close()}).catch(e=>console.log(e))},p.open(),f.form.name.value=document.querySelector(\".user-info__name\").textContent,f.form.occupation.value=document.querySelector(\".user-info__job\").textContent,f.setEventListener(event),c.addEventListener(\"click\",()=>{p.close()})})}]);","extractedComments":[]}